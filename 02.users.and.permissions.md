- [Basic](#basic)
  - [Who am I](#who-am-i)
  - [Create a new user](#create-a-new-user)
  - [Change password](#change-password)
  - [Delete a user](#delete-a-user)
  - [Create a new group](#create-a-new-group)
  - [Delete a group](#delete-a-group)
  - [Add a user to a group](#add-a-user-to-a-group)
  - [List groups that a user belongs to](#list-groups-that-a-user-belongs-to)
  - [List members of a group](#list-members-of-a-group)
  - [Change file/directory owner](#change-filedirectory-owner)
- [Advanced](#advanced)
  - [Change file/directory permissions](#change-filedirectory-permissions)
  - [Execute commands as superuser](#execute-commands-as-superuser)


# Basic

## Who am I
Get your username:
```console
user@ubuntu:/$ whoami
user
```

Get more detailed informations about your username, like your `uid` and groups you belong to: 
```console
user@ubuntu:/$ id
uid=1000(user) gid=1000(user) groups=1000(user),27(sudo)
```

## Create a new user
```console
user@ubuntu:/$ sudo adduser user2
[sudo] password for user:
Adding user `user2' ...
Adding new group `user2' (1001) ...
Adding new user `user2' (1001) with group `user2' ...
Creating home directory `/home/user2' ...
Copying files from `/etc/skel' ...
Enter new UNIX password:
Retype new UNIX password:
passwd: password updated successfully
Changing the user information for user2
Enter the new value, or press ENTER for the default
        Full Name []: Amine M
        Room Number []:
        Work Phone []:
        Home Phone []:
        Other []:
Is the information correct? [Y/n] y
```

Nothing will be showed while you type the user password, not even `*`.

## Change password
Change your password (the current user password):
```console
user@ubuntu:/$ sudo passwd
[sudo] password for user: 
Enter new UNIX password: 
Retype new UNIX password: 
passwd: password updated successfully
```

Change another user password:
```console
user@ubuntu:/$ sudo passwd user2
[sudo] password for user: 
Enter new UNIX password: 
Retype new UNIX password: 
passwd: password updated successfully
```

Nothing will be showed while you type the user password, not even `*`.


## Delete a user
Delete a user:
```console
user@ubuntu:/$ sudo deluser user2
[sudo] password for user:
Removing user `user2' ...
Warning: group `user2' has no more members.
Done.
```

Delete a user and his home directory:
```console
user@ubuntu:/$ sudo deluser --remove-home user2
[sudo] password for user:
Looking for files to backup/remove ...
Removing files ...
Removing user `user2' ...
Warning: group `user2' has no more members.
Done.
```

## Create a new group
```console
user@ubuntu:/$ sudo addgroup mygroup
[sudo] password for user: 
Adding group `mygroup' (GID 1001) ...
Done.
```

## Delete a group
```console
user@ubuntu:/$ sudo delgroup mygroup
[sudo] password for user: 
Removing group `mygroup' ...
Done.
```


## Add a user to a group
Add a user to single group:
```console
user@ubuntu:/$ sudo usermod -aG mygroup user2
```

## List groups that a user belongs to
```console
user@ubuntu:/$ groups user2
user2 : user2 mygroup
```

## List members of a group
```console
user@ubuntu:/$ grep 'mygroup:' /etc/group
mygroup:x:1001:user,user2
```

## Change file/directory owner
Change a file/directory owner and group:
```console
user@ubuntu:~$ sudo chown user2:user2 Documents/file.txt 
user@ubuntu:~$ ls -l Documents/file.txt 
-rw-r--r-- 1 user2 user2 5 Jun  4 23:25 Documents/file.txt
```

Change a a directory owner and group recursively:
```console
user@ubuntu:~$ sudo chown -R user2:user2 Pictures/
user@ubuntu:~$ ls -l Pictures/
total 56
-rw-r--r-- 1 user2 user2 28991 Apr 13  2019 2019-04-13.png
-rw-r--r-- 1 user2 user2 24221 May 19  2019 2019-05-19.png
```

# Advanced
## Change file/directory permissions
Give the owner of the file read,write,execute permissions ; the group of the file read,write permissions ; the other users read permission only:
```console
user@ubuntu:~$ chmod u=rwx,g=rw,o=r Documents/file.txt
user@ubuntu:~$ ls -l Documents/file.txt 
-rwxrw-r-- 1 user user 5 Jun  4 23:25 Documents/file.txt
```

Add execute permissions for other users:
```console
user@ubuntu:~$ chmod o+x Documents/file.txt 
user@ubuntu:~$ ls -l Documents/file.txt 
-rwxrw-r-x 1 user user 5 Jun  4 23:25 Documents/file.txt
```

Remove write permission from the group of the file:
```console
user@ubuntu:~$ chmod g-w Documents/file.txt 
user@ubuntu:~$ ls -l Documents/file.txt 
-rwxr--r-x 1 user user 5 Jun  4 23:25 Documents/file.txt
```

Remove execute permissions from the owner of the file:
```console
user@ubuntu:~$ chmod u-x Documents/file.txt 
user@ubuntu:~$ ls -l Documents/file.txt 
-rw-r--r-x 1 user user 5 Jun  4 23:25 Documents/file.txt
```

All previous `chmod` examples can be used the same with directories.

A good tutorial about `chmod` usage to manipulate files/dirs permissions: [https://www.howtogeek.com/437958/how-to-use-the-chmod-command-on-linux/](https://www.howtogeek.com/437958/how-to-use-the-chmod-command-on-linux/)


## Execute commands as superuser
Some actions needs a superuser (root) access to be performed (like changing system sensitive files, create new user ...).

To execute a command as superuser (root), we need to precede the command with `sudo`:
```console
user@ubuntu:~$ sudo id 
[sudo] password for user: 
uid=0(root) gid=0(root) groups=0(root)
```

To switch to a superuser (root) shell:
```console
user@ubuntu:/$ sudo -s
[sudo] password for user: 
root@ubuntu:/# id
uid=0(root) gid=0(root) groups=0(root)
root@ubuntu:/# whoami
root
```

To go back to normal user, we use the command `exit`:
```console
root@ubuntu:/# exit
exit
user@ubuntu:/$
```

Nothing will be showed while you type your password, not even `*`.

<!-- ## Allow a user to execute commands as superuser
Not all users can execute commands as superuser. When a user doesn't have the right, try to use sudo, he will face the following message:
```console
user2@ubuntu:/$ sudo id
[sudo] password for user2: 
user2 is not in the sudoers file.  This incident will be reported.
```

To allow a user to execute commands as superuser using sudo, we need to add to the group `sudo` in _Ubuntu_, 
```console -->

<!--
Allow a user to execute commands as root
Execute command as another user
Login as another user
files /etc/passwd and /etc/group
chattr
-->